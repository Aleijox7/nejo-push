{% extends 'AppBundle:Default:base.html.twig' %}
{% block wrapper %}
	<div class="col-xs-12">
		<div style="float: right;margin-top:10px;" hidden>
			<span style="position: relative;top: 3px;"><i class="fa fa-bell"></i> Activar notificaciones</span>
			<label class="switch switch--material">
				<input id="switchNotifications" type="checkbox" class="switch__input switch--material__input" checked>
				<div class="switch__toggle switch--material__toggle">
					<div class="switch__handle switch--material__handle">
					</div>
				</div>
			</label>
		</div>
		<div class="col-xs-12">
			<h1>OK</h1>
			<div class="col-xs-12 text-center">
				<div class="col-sm-6 divProgress">
					<div class="progress">
						<div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
						</div>
					</div>
				</div>
			</div>
			<a class="btn-gradient" id="btnNotification"><span>Boton</span></a>
		</div>
	</div>
{% endblock %}
{% block javascriptsAdcionales %}
{{parent()}}
<script type="text/javascript">
var width = 0;
var timerProcess = setInterval(function(){}, 200000);

function clearProgressBar() {
	$('.progress-bar').width('0%');
	stopProgressBar();
	width = 0;
}

function stopProgressBar() {
    clearInterval(timerProcess);
}

$('#btnNotification').click(function(){
	startProgressBar();
	path = "{{path('send_notifications')}}";
	token = "{{app.session.get('jwt')}}";
	$.ajax({
		method: "POST",
		url: path,
		data: { id: 1},
		beforeSend: function(request) {
			request.setRequestHeader("token", token);
		},
		completed: function(response) {
			console.log(response);
			finishProgressBar();
		},
	});
	
	changeFaviconAddNotification();
});

function startProgressBar(){
	var timerProcess = setInterval(function(){ sumProgressBar() }, 50);
}

function sumProgressBar(){
	if (width < 100) {
		width = width+1;
		$('.progress-bar').width(width+'%');
	}
}

function finishProgressBar(){
	stopProgressBar();
	$('.progress-bar').width('100%');
}
</script>
{% endblock %}	